---
title:  WykÅ‚ad 2
format:
  html:
    code-fold: true
jupyter: python3
---

 
â³ Czas trwania: 1,5h
*ğŸ¯ Cel wykÅ‚adu* 

zrozumienie, jak dane ewoluowaÅ‚y w rÃ³Å¼nych branÅ¼ach i jakie narzÄ™dzia sÄ… dziÅ› wykorzystywane do ich analizy.

---

Na tym wykÅ‚adzie przedstawimy ewolucjÄ™ analizy danych, pokazujÄ…c, jak zmieniaÅ‚y siÄ™ technologie i podejÅ›cia do przetwarzania danych na przestrzeni lat. 
Rozpoczniemy od klasycznych struktur tabelarycznych, przez bardziej zaawansowane modele grafowe i tekstowe, aÅ¼ po nowoczesne podejÅ›cie do strumieniowego przetwarzania danych. 


# Ewolucja danych 

##  Dane tabelaryczne (tabele SQL)
PoczÄ…tkowo dane byÅ‚y przechowywane w postaci tabel, gdzie kaÅ¼da tabela zawieraÅ‚a zorganizowane informacje w kolumnach i wierszach (np. bazy danych SQL).  
Modele takie doskonale nadawaÅ‚y siÄ™ do danych **ustrukturyzowanych**.  

### ğŸ“Œ Cechy:
âœ… Dane podzielone na kolumny o staÅ‚ej strukturze.  
âœ… MoÅ¼liwoÅ›Ä‡ stosowania operacji CRUD (Create, Read, Update, Delete).  
âœ… ÅšcisÅ‚e reguÅ‚y spÃ³jnoÅ›ci i normalizacji.  

### ğŸ“Œ PrzykÅ‚ady:  
â¡ï¸ Systemy bankowe, e-commerce, ERP, systemy CRM.  

### ğŸ–¥ï¸ PrzykÅ‚adowy kod w Pythonie (SQLite):  
```python
import sqlite3
conn = sqlite3.connect(':memory:')
cursor = conn.cursor()
cursor.execute("CREATE TABLE users (id INTEGER PRIMARY KEY, name TEXT, age INTEGER)")
cursor.execute("INSERT INTO users (name, age) VALUES ('Alice', 30)")
cursor.execute("SELECT * FROM users")
print(cursor.fetchall())
conn.close()
```

---

## Dane grafowe  
Wraz z rozwojem potrzeb biznesowych pojawiÅ‚y siÄ™ **dane grafowe**, w ktÃ³rych relacje miÄ™dzy obiektami sÄ… reprezentowane jako **wierzchoÅ‚ki i krawÄ™dzie**.  

### ğŸ“Œ Cechy:  
âœ… Dane opisujÄ…ce relacje i powiÄ…zania.  
âœ… Elastyczna struktura (grafy zamiast tabel).  
âœ… MoÅ¼liwoÅ›Ä‡ analizy poÅ‚Ä…czeÅ„ (np. algorytmy PageRank, centralnoÅ›Ä‡).  

### ğŸ“Œ PrzykÅ‚ady:  
â¡ï¸ Sieci spoÅ‚ecznoÅ›ciowe (Facebook, LinkedIn), wyszukiwarki (Google), systemy rekomendacji (Netflix, Amazon).  

### ğŸ–¥ï¸ PrzykÅ‚adowy kod w Pythonie (Graf Karate - NetworkX): 
```{python}
import networkx as nx
G = nx.karate_club_graph()
nx.draw(G, with_labels=True)
```

---

## Dane pÃ³Å‚strukturyzowane (JSON, XML, YAML)  
Dane te nie sÄ… w peÅ‚ni ustrukturyzowane jak w bazach SQL, ale majÄ… pewien schemat.  

### ğŸ“Œ Cechy:  
âœ… Hierarchiczna struktura (np. klucz-wartoÅ›Ä‡, obiekty zagnieÅ¼dÅ¼one).  
âœ… Brak Å›cisÅ‚ego schematu (moÅ¼liwoÅ›Ä‡ dodawania nowych pÃ³l).  
âœ… PopularnoÅ›Ä‡ w systemach NoSQL i API.  

### ğŸ“Œ PrzykÅ‚ady:  
â¡ï¸ Dokumenty w MongoDB, pliki konfiguracyjne, REST API, pliki logÃ³w.  

### ğŸ–¥ï¸ PrzykÅ‚adowy kod w Pythonie (JSON):  
```{python}
import json
data = {'name': 'Alice', 'age': 30, 'city': 'New York'}
json_str = json.dumps(data)
print(json.loads(json_str))
```

---

## Dane tekstowe (NLP) 
Tekst staÅ‚ siÄ™ kluczowym ÅºrÃ³dÅ‚em informacji, szczegÃ³lnie w analizie opinii, chatbotach czy wyszukiwarkach.  

### ğŸ“Œ Cechy:
âœ… Nieustrukturyzowane dane wymagajÄ…ce przeksztaÅ‚cenia.  
âœ… Stosowanie **embeddingÃ³w** (np. Word2Vec, BERT, GPT).  
âœ… DuÅ¼e zastosowanie w analizie sentymentu i chatbotach.  

### ğŸ“Œ PrzykÅ‚ady:  
â¡ï¸ Media spoÅ‚ecznoÅ›ciowe, e-maile, chatboty, tÅ‚umaczenie maszynowe.  

### ğŸ–¥ï¸ PrzykÅ‚adowy kod w Pythonie:  
```{python}
import ollama

# PrzykÅ‚adowe zdanie
sentence = "Sztuczna inteligencja zmienia Å›wiat."
response = ollama.embeddings(model='llama3.2', prompt=sentence)
embedding = response['embedding']
print(embedding[:4])
```

---

## Dane multimedialne (obrazy, dÅºwiÄ™k, wideo)
Nowoczesne systemy analizy danych wykorzystujÄ… rÃ³wnieÅ¼ obrazy i dÅºwiÄ™k.  

### ğŸ“Œ Cechy:  
âœ… WymagajÄ… duÅ¼ej mocy obliczeniowej (sztuczna inteligencja, deep learning).  
âœ… Przetwarzane przez modele CNN (obrazy) i RNN/Transformers (dÅºwiÄ™k).  

### ğŸ“Œ PrzykÅ‚ady:  
â¡ï¸ Rozpoznawanie twarzy, analiza mowy, biometria, analiza treÅ›ci wideo.  

### ğŸ–¥ï¸ PrzykÅ‚adowy kod w Pythonie (Obraz - OpenCV):  
```python
import cv2
image = cv2.imread('cloud.jpeg')
cv2.waitKey(0)
cv2.destroyAllWindows()
```
---

## Dane strumieniowe
Obecnie najbardziej dynamicznie rozwija siÄ™ analiza **danych strumieniowych**, gdzie dane sÄ… analizowane na bieÅ¼Ä…co, w miarÄ™ ich napÅ‚ywania.  

### ğŸ“Œ Cechy:  
âœ… Przetwarzanie w czasie rzeczywistym.  
âœ… Wykorzystanie technologii takich jak Apache Kafka, Flink, Spark Streaming.  

### ğŸ“Œ PrzykÅ‚ady:  
â¡ï¸ Transakcje bankowe (detekcja oszustw), analiza social media, IoT.  

### ğŸ–¥ï¸ PrzykÅ‚adowy kod w Pythonie (Strumieniowe transakcje bankowe):  
```{python}
import time
transactions = [{'id': 1, 'amount': 100}, {'id': 2, 'amount': 200}]
for transaction in transactions:
    print(f"Processing transaction: {transaction}")
    time.sleep(1)
```

---

## Dane sensoryczne i IoT 
Dane z czujnikÃ³w i urzÄ…dzeÅ„ IoT sÄ… kolejnym krokiem w ewolucji.  

### ğŸ“Œ Cechy:  
âœ… CzÄ™sto pochodzÄ… z miliardÃ³w urzÄ…dzeÅ„ (big data).  
âœ… WymagajÄ… analizy brzegowej (_edge computing_).  

### ğŸ“Œ PrzykÅ‚ady:  
â¡ï¸ Smart home, wearables, samochody autonomiczne, systemy przemysÅ‚owe.  

### ğŸ–¥ï¸ PrzykÅ‚adowy kod w Pythonie (Sensor - temperatura):  
```{python}
import random
def get_temperature():
    return round(random.uniform(20.0, 25.0), 2)
print(f"Current temperature: {get_temperature()}Â°C")
```

# Rzeczywisty proces generowania danych

Dane generowane sÄ… w postaci nieograniczonej - pojawiajÄ… siÄ™ na skutek ciÄ…gÅ‚ych dziaÅ‚aÅ„ systemÃ³w.
W swoim telefonie wygenerowaÅ‚eÅ› dziÅ› (a nawet na tych zajÄ™ciach!) wiele danych.
Czy na nastÄ™pnych zajÄ™ciach lub teÅ¼ jutro nie bÄ™dziesz ich generowaÅ‚?

> Dane zawsze generowane sÄ… jako forma strumienia danych.

ğŸ“Œ Systemy obsÅ‚ugujÄ…ce strumienie danych:

- Hurtownie danych
- Systemy monitorujÄ…ce dziaÅ‚ania urzÄ…dzeÅ„ (IoT)
- Systemy transakcyjne
- Systemy analityczne stron www
- Reklamy on-line
- Media spoÅ‚ecznoÅ›ciowe
- Systemy logowania

> Firma to organizacja, ktÃ³ra generuje i odpowiada na ciÄ…gÅ‚y strumieÅ„ danych.

W przetwarzaniu wsadowym ÅºrÃ³dÅ‚em (ale i wynikiem przetwarzania) danych jest **plik**.

Jest on zapisywany raz i moÅ¼na siÄ™ do niego odwoÅ‚aÄ‡ (moÅ¼e na nim dziaÅ‚aÄ‡ wiele procesÃ³w - zadaÅ„).

Nazwa pliku to element identyfikujÄ…cy zbiÃ³r rekordÃ³w.

W przypadku strumienia zdarzenie jest generowane tylko raz przez tzw. producenta (zwanego teÅ¼ nadawcÄ… lub dostawcÄ…).
PowstaÅ‚e zdarzenie przetwarzane moÅ¼e byÄ‡ przez wielu tzw. konsumentÃ³w (odbiorcÃ³w).
Zdarzenia strumieniowe grupowane sÄ… w tzw. tematy (ang. topics).


# DuÅ¼e dane 

Kiedy podjÄ…Ä‡ decyzjÄ™ biznesowÄ… ?

<img alt="Batch Processing" src="../img/batch0.png" class="center" />

## Hadoop Map-Reduce â€“ Skalowanie obliczeÅ„ na Big Data

Kiedy mÃ³wimy o skalowalnym przetwarzaniu danych, pierwszym skojarzeniem moÅ¼e byÄ‡ Google.  
Ale co tak naprawdÄ™ sprawia, Å¼e moÅ¼emy wyszukiwaÄ‡ informacje w uÅ‚amku sekundy, przetwarzajÄ…c petabajty danych?  

ğŸ‘‰ Czy wiesz, Å¼e nazwa "Google" pochodzi od sÅ‚owa "Googol", czyli liczby rÃ³wnej 10Â¹â°â°?  
To wiÄ™cej niÅ¼ liczba atomÃ³w w znanym WszechÅ›wiecie! ğŸŒŒ  

### ğŸ”¥ Wyzwanie: Czy uda Ci siÄ™ zapisaÄ‡ liczbÄ™ Googol do koÅ„ca zajÄ™Ä‡?  

---  

## ğŸ” Dlaczego SQL i klasyczne algorytmy nie wystarczajÄ…? 

Tradycyjne **bazy danych SQL** czy **jednowÄ…tkowe algorytmy** zawodzÄ…, gdy skala danych przekracza pojedynczy komputer.  
W tym miejscu pojawia siÄ™ **MapReduce** â€“ rewolucyjny model obliczeniowy stworzony przez Google.  

### ğŸ› ï¸ RozwiÄ…zania Google dla Big Data:  
âœ… **Google File System (GFS)** â€“ rozproszony system plikÃ³w.  
âœ… **Bigtable** â€“ system do przechowywania ogromnych iloÅ›ci ustrukturyzowanych danych.  
âœ… **MapReduce** â€“ algorytm podziaÅ‚u pracy na wiele maszyn.  

## Graficzne przedstawienie MapReduce

###  Mapowanie rozdziela zadania (Map)
KaÅ¼de wejÅ›cie dzielone jest na mniejsze czÄ™Å›ci i przetwarzane rÃ³wnolegle.  

ğŸŒ WyobraÅº sobie, Å¼e masz **ksiÄ…Å¼kÄ™ telefonicznÄ…** i chcesz znaleÅºÄ‡ wszystkie osoby o nazwisku "Nowak".  
â¡ï¸ **Podziel ksiÄ…Å¼kÄ™ na fragmenty i daj kaÅ¼demu do przeanalizowania jeden fragment.**  

### Redukcja zbiera wyniki (Reduce)  
Wszystkie czÄ™Å›ciowe wyniki sÄ… Å‚Ä…czone w jednÄ…, koÅ„cowÄ… odpowiedÅº.  

ğŸ”„ Wszyscy uczniowie zgÅ‚aszajÄ… swoje wyniki, a jeden student zbiera i podsumowuje odpowiedÅº.  

<img alt="MapReduce w dziaÅ‚aniu â€“ rozdzielanie i agregowanie danych" src="../img/mapreduce_flow.png" class="center" />
---  

## ğŸ’¡ Klasyczny przykÅ‚ad: Liczenie sÅ‚Ã³w w tekÅ›cie  
ZaÅ‚Ã³Å¼my, Å¼e mamy miliony ksiÄ…Å¼ek i chcemy policzyÄ‡, ile razy wystÄ™puje kaÅ¼de sÅ‚owo.  

### ğŸ–¥ï¸ Kod MapReduce w Pythonie (z uÅ¼yciem multiprocessing)  

```python
from multiprocessing import Pool
from collections import Counter

# Funkcja Map (podziaÅ‚ tekstu na sÅ‚owa)
def map_function(text):
    words = text.split()
    return Counter(words)

# Funkcja Reduce (sumowanie wynikÃ³w)
def reduce_function(counters):
    total_count = Counter()
    for counter in counters:
        total_count.update(counter)
    return total_count

texts = [
        "big data is amazing",
        "data science and big data",
        "big data is everywhere"
    ]
if __name__ == '__main__':    
    with Pool() as pool:
        mapped_results = pool.map(map_function, texts)
    
    final_result = reduce_function(mapped_results)
    print(final_result)

# Counter({'data': 4, 'big': 3, 'is': 2, 'amazing': 1, 'science': 1, 'and': 1, 'everywhere': 1})
```

### ğŸ”¹ Co tu siÄ™ dzieje?  
âœ… KaÅ¼dy fragment tekstu jest przetwarzany niezaleÅ¼nie (**map**).  
âœ… Wyniki sÄ… zbierane i sumowane (**reduce**).  
âœ… **Efekt:** MoÅ¼emy przetwarzaÄ‡ **terabajty tekstu rÃ³wnolegle**!  

<img alt="Batch Processing" src="../img/batch3.png" class="center" />

---  

## ğŸ¨ Wizualizacja â€“ PorÃ³wnanie klasycznego podejÅ›cia i MapReduce  

ğŸ“Š **Stare podejÅ›cie** â€“ Jeden komputer wykonuje wszystko sekwencyjnie.  
ğŸ“Š **Nowe podejÅ›cie (MapReduce)** â€“ KaÅ¼da maszyna liczy fragment i wyniki sÄ… agregowane.  


<img alt="MapReduce Processing" src="../img/mapreduce_vs_classic.png" class="center" />

---  

## ğŸš€ Wyzwanie dla Ciebie! 

ğŸ”¹ **ZnajdÅº i uruchom swÃ³j wÅ‚asny algorytm MapReduce w dowolnym jÄ™zyku!**  
ğŸ”¹ **Czy potrafisz zaimplementowaÄ‡ wÅ‚asny MapReduce do innego zadania?** (np. analiza logÃ³w, zliczanie klikniÄ™Ä‡ na stronie)  


## Big Data

Systemy Big data mogÄ… byÄ‡ czÄ™Å›ciÄ… (ÅºrÃ³dÅ‚em) dla hurtowni danych (np. Data Lake, Enterprise Data Hub)

Ale Hurtownie danych nie sÄ… systemami Big Data!

1. Hurtownie danych
- przetrzymywanie danych wysoko strukturyzowanych
- skupione na analizach i procesie raportowania
- 100\% accuracy

2. Big Data
- dane o dowolnej strukturze
- sÅ‚uÅ¼y do rÃ³Å¼norodnych celÃ³w opartych na danych (analityka, data science ...)
- poniÅ¼ej 100\% accuracy

> _,,Big Data is like teenage sex: everyone talks about it, nobody really knows how to do it, everyone thinks everyone else is doing it, so every one claims they are doing it.''_ â€” Dan Ariely, Professor of Psychology and Behavioral Economics, Duke University

### one, two, ... four V

1. **Volume**  (ObjÄ™toÅ›Ä‡) - rozmiar danych produkowanych na caÅ‚ym Å›wiecie przyrasta w tempie wykÅ‚adniczym.
2. **Velocity** (SzybkoÅ›Ä‡) - tempo produkowania danych, szybkoÅ›ci ich przesyÅ‚ania i przetwarzania.
3. **Variety** (ZrÃ³Å¼nicowanie) - tradycyjne dane kojarzÄ… siÄ™ nam z postaciÄ… alfanumerycznÄ… zÅ‚oÅ¼onÄ… z liter i cyfr. Obecnie mamy do dyspozycji obrazy, dÅºwiÄ™ki, pliki wideo, strumienie danych z IoT
4. **Veracity** (WiarygodnoÅ›Ä‡) - Czy dane sÄ… kompletne i poprawne? Czy obiektywnie odzwierciedlajÄ… rzeczywistoÅ›Ä‡? Czy sÄ… podstawÄ… do podejmowania decyzji?
5. **Value** - The value that the data actually holds. In the end, it's all about cost and benefits.

> _Celem obliczeÅ„ nie sÄ… liczby, lecz ich zrozumienie_ R.W. Hamming 1962. 


## Modele przetwarzania danych

Dane w biznesie przetwarzane sÄ… praktycznie od zawsze. 
W ciÄ…gu ostatnich dziesiÄ™cioleci iloÅ›Ä‡ przetwarzanych danych systematycznie roÅ›nie co wpÅ‚ywa na proces przygotowania i przetwarzania danych.

### TrochÄ™ historii

- Lata 60-te : Kolekcje danych, bazy danych
- Lata 70-te : Relacyjne modele danych i ich implementacja w systemach OLTP
- 1975 : Pierwsze komputery osobiste 
- Lata 80-te : Zaawansowane modele danych, extended-relational, objective oriented, aplikacyjno-zorientowane itp.
- 1983 : PoczÄ…tek internetu
- Lata 90-te : Data mining, hurtownie danych, systemy OLAP
- PÃ³Åºniej : NoSQL, Hadoop, SPARK, data lake
- 2002 : AWS , 2005: Hadoop, Cloud computing 


WiÄ™kszoÅ›Ä‡ danych przechowywana jest w bazach lub hurtowniach danych.
Standardowo dostÄ™p do danych sprowadza siÄ™ najczÄ™Å›ciej do realizacji zapytaÅ„ poprzez aplikacjÄ™.

SposÃ³b wykorzystania i realizacji procesu dostÄ™pu do bazy danych nazywamy **modelem przetwarzania**.
NajczÄ™Å›ciej uÅ¼ywane sÄ… dwie implementacje:

### Model Tradycyjny

**Model tradycyjny** - przetwarzanie transakcyjne w trybie on-line, OLTP (on-line transaction processing).
Åšwietnie sprawdza siÄ™ w przypadku obsÅ‚ugi bieÅ¼Ä…cej np. obsÅ‚uga klienta, rejestr zamÃ³wieÅ„, obsÅ‚uga sprzedaÅ¼y itp.
Wykorzystywany w systemach Enterprise Resource Planning (ERP) Systems, Customer Relationship Management (CRM) software, and web-based applications.

![](../img/baza1.png){.center}

Model ten dostarcza efektywnych rozwiÄ…zaÅ„ m.in do:

- efektywnego i bezpiecznego przechowywania danych,
- transakcyjnego odtwarzanie danych po awarii,
- optymalizacji dostÄ™pu do danych,
- zarzÄ…dzania wspÃ³Å‚bieÅ¼noÅ›ciÄ…,
- przetwarzania zdarzeÅ„ -> odczyt -> zapis

Co w przypadku gdy mamy do czynienia z:

- agregacjami danych z wielu systemÃ³w (np. dla wielu sklepÃ³w),
- raportowanie i podsumowania danych,
- optymalizacja zÅ‚oÅ¼onych zapytaÅ„,
- wspomaganie decyzji biznesowych.

Badania nad tego typu zagadnieniami doprowadziÅ‚y do sformuÅ‚owania nowego modelu przetwarzania danych oraz nowego typu baz danych - **Hurtownie Danych** _(Data warehouse)_.

### Model OLAP

**Przetwarzanie analityczne on-line OLAP (on-line analytic processing).**

 Wspieranie procesÃ³w analizy i dostarczanie narzÄ™dzi umoÅ¼liwiajÄ…cych analizÄ™ wielowymiarowÄ… (`czas`, `miejsce`, `produkt`).

 Proces zrzucania danych z rÃ³Å¼nych systemÃ³w do jednej bazy nazywamy Extract-Transform-Load (ETL) (normalizacja i encoding and schema transaction).

 Analiza danych z hurtowni to przede wszystkim obliczanie **agregatÃ³w** (podsumowaÅ„) dotyczÄ…cych wymiarÃ³w hurtowni.
 Proces ten jest caÅ‚kowicie sterowany przez uÅ¼ytkownika.

**PrzykÅ‚ad**

ZaÅ‚Ã³Å¼my, Å¼e mamy dostÄ™p do hurtowni danych gdzie przechowywane sÄ… informacje dotyczÄ…ce sprzedaÅ¼y produktÃ³w w supermarkecie.
Jak przeanalizowaÄ‡ zapytania:

1. Jaka jest Å‚Ä…czna sprzedaÅ¼ produktÃ³w w kolejnych kwartaÅ‚ach, miesiÄ…cach, tygodniach ?
2. Jaka jest sprzedaÅ¼ produktÃ³w z podziaÅ‚em na rodzaje produktÃ³w ?
3. Jaka jest sprzedaÅ¼ produktÃ³w z podziaÅ‚em na oddziaÅ‚y supermarketu ?

Odpowiedzi na te pytania pozwalajÄ… okreÅ›liÄ‡ `wÄ…skie gardÅ‚a` sprzedaÅ¼y produktÃ³w przynoszÄ…cych deficyt, zaplanowaÄ‡ zapasy w magazynach czy porÃ³wnaÄ‡ sprzedaÅ¼ rÃ³Å¼nych grup w rÃ³Å¼nych oddziaÅ‚ach supermarketu.

W ramach Hurtowni Danych najczÄ™Å›ciej wykonuje siÄ™ dwa rodzaje zapytaÅ„(oba w trybie batchowym):
1. Wykonywane okresowo w czasie zapytania raportowe obliczajÄ…ce biznesowe statystyki
2. Wykonywane ad-hoc zapytania wspomagajÄ…ce krytyczne decyzje biznesowe.

![](../img/baza2.png){.center}

